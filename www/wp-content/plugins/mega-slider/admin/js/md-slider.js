(function(e){function t(t){var n=[],r=JSON.parse(e("#mega-old").val()),i;e("#md-tabs").find(".md-tabcontent").each(function(){n.push(JSON.parse(e(".panelsettings",this).val()).fid)});i={action:"mega_resize_bg",fid:n,crop:t,oldWidth:r.width,oldHeight:r.height,width:e("#md-settings-width").val(),height:e("#md-settings-height").val()};e.post(ajaxurl,i,function(t){var n=JSON.parse(t);e("#md-tabs").find(".md-tabcontent").each(function(){var t=e(".md-slide-image",this);t.find("img").remove();t.append(e("<img>").attr("src",n.shift()))})})}function n(){var t=[],n=JSON.parse(e("#mega-old").val()),r;e("#md-tabs").find(".md-tabcontent").each(function(){var n=JSON.parse(e(".panelsettings",this).val()).fid;t.push(n)});r={action:"mega_delete_bg",fid:t,width:e("#md-settings-width").val(),height:e("#md-settings-height").val()};e.post(ajaxurl,r,function(t){var n=JSON.parse(t);e("#md-tabs").find(".md-tabcontent").each(function(){var t=e(".md-slide-image",this);t.find("img").remove();t.append(e("<img>").attr("src",n.shift()))})})}function r(t,n,r){var i='<div class="'+n+'wrap clearfix">';var s=0;for($i=0;$i<=r;$i++){s=e(t+" option:eq("+$i+")").val();if(s){i+='<div id="'+n+s+'" class="slitem"></div>'}}i+="</div>";e(t).parent().append(i);var o=e(t+" option[selected]").val();e("#"+n+o).addClass("selected");e("."+n+"wrap .slitem").each(function(){e(this).click(function(){e("."+n+"wrap .selected").removeClass("selected");e(this).addClass("selected");e(t+" option[selected]").removeAttr("selected");tmpindex=e(this).attr("id").replace(n,"");e(t+" option[value="+tmpindex+"]").attr("selected","selected")})});e(t).hide()}e(document).ready(function(){var i=e(".md-wrap").data("url");var s=new MdSliderPanel(i);s.init();if(e("#md-tabs").find(".md-tabs-head").find("li").length===0){e("#add_tab").click()}e("#secondpublish").click(function(t){t.preventDefault();e("#publish").click()});r("#md-settings-posThumb","tp",4);r("#md-settings-styleBorder","bs",10);e("#post").submit(function(t){var n=e.objectToString(s.getSliderData());e("#md-slider-data").val(n);e(".mdt-text, .mdt-input, .mdt-select, .mdt-textarea").attr("disabled","disabled")});e('input[name="md-settings[showLoading]"]').change(function(){if(this.value==1){e(".md-settings-sub-showLoading").show()}else{e(".md-settings-sub-showLoading").hide()}});e("#md-settings-showBullet").change(function(){if(e(this).is(":checked")){e(".md-settings-posThumb").hide();e(".md-settings-sub-showBullet").show()}else{if(e("#md-settings-showThumb").is(":checked"))e(".md-settings-posThumb").show();e(".md-settings-sub-showBullet").hide()}});e("#md-settings-showThumb").change(function(){if(e(this).is(":checked")){e(".md-settings-sub-showThumb").not(".md-settings-posThumb").show();if(e("#md-settings-showBullet").is(":checked")){e(".md-settings-sub-showThumb.md-settings-posThumb").hide()}else{e(".md-settings-sub-showThumb.md-settings-posThumb").show()}}else{e(".md-settings-sub-showThumb").hide()}});e("#videothumb-pick").click(function(){var t=this,n=wp.media.editor.send.attachment;wp.media.editor.send.attachment=function(t,r){var i=e("#videothumb"),s=i.attr("src");if(r.url&&r.url!==""){i.attr("src",r.url)}wp.media.editor.send.attachment=n};wp.media.editor.open()});e("#md-settings-fullwidth").change(function(){var r=e("#md-settings-width").siblings("label");if(e(this).is(":checked")){r.text("Effect zone width");e(".md-slidewrap").addClass("md-fullwidth").css("width","");e(".md-slide-image").css("width","");e(".md-settings-bgstyle").hide();if(e(this).hasClass("md-ajax-ready")){n()}else{e(this).addClass("md-ajax-ready")}}else{r.text("Width");e(".md-slidewrap").removeClass("md-fullwidth").css("width",e("#md-settings-width").val());e(".md-slide-image").css("width",e("#md-settings-width").val());e(".md-settings-bgstyle").show();if(e(this).hasClass("md-ajax-ready")){t(true)}else{e(this).addClass("md-ajax-ready")}}}).trigger("change");e("#md-settings-bgstyle").change(function(){if(e(this).is(":checked")&&!e("#md-settings-fullwidth").is(":checked")){t(true)}else{n()}})})})(jQuery)